{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL.000\\\\Desktop\\\\core4\\\\core4\\\\src\\\\components\\\\InspectionViewModal.js\",\n  _s = $RefreshSig$();\n// InspectionViewModalWithAI.jsx\nimport React, { useState, useEffect, useRef } from \"react\";\nimport '../style/InspectionViewModal.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function InspectionViewModal({\n  inspection,\n  transformers,\n  onClose,\n  updateInspection,\n  updateTransformer\n}) {\n  _s();\n  const transformer = transformers.find(t => t.id === inspection.transformer);\n  const uploader = \"Admin\";\n  const weatherOptions = [\"Sunny\", \"Rainy\", \"Cloudy\"];\n\n  // --- Baseline state ---\n  const [baselineImage, setBaselineImage] = useState(inspection.baselineImage || (transformer === null || transformer === void 0 ? void 0 : transformer.baselineImage) || null);\n  const [baselineWeather, setBaselineWeather] = useState(inspection.baselineWeather || (transformer === null || transformer === void 0 ? void 0 : transformer.weather) || \"Sunny\");\n  const [baselineUploadDate, setBaselineUploadDate] = useState(inspection.baselineUploadDate || (transformer === null || transformer === void 0 ? void 0 : transformer.baselineUploadDate) || null);\n  const [localBaselineChanged, setLocalBaselineChanged] = useState(false);\n  useEffect(() => {\n    if (!localBaselineChanged) {\n      setBaselineImage((transformer === null || transformer === void 0 ? void 0 : transformer.baselineImage) || null);\n      setBaselineWeather((transformer === null || transformer === void 0 ? void 0 : transformer.weather) || \"Sunny\");\n      setBaselineUploadDate((transformer === null || transformer === void 0 ? void 0 : transformer.baselineUploadDate) || null);\n    }\n  }, [transformer, localBaselineChanged]);\n  const [baselineImageURL, setBaselineImageURL] = useState(null);\n  useEffect(() => {\n    if (!baselineImage) {\n      setBaselineImageURL(null);\n      return;\n    }\n    if (baselineImage instanceof File || baselineImage instanceof Blob) {\n      const url = URL.createObjectURL(baselineImage);\n      setBaselineImageURL(url);\n      return () => URL.revokeObjectURL(url);\n    } else {\n      setBaselineImageURL(baselineImage);\n    }\n  }, [baselineImage]);\n\n  // --- Maintenance state ---\n  const [maintenanceImage, setMaintenanceImage] = useState(inspection.maintenanceImage || null);\n  const [maintenanceWeather, setMaintenanceWeather] = useState(inspection.maintenanceWeather || \"Sunny\");\n  const [maintenanceUploadDate, setMaintenanceUploadDate] = useState(inspection.maintenanceUploadDate || null);\n  const [localMaintenanceChanged, setLocalMaintenanceChanged] = useState(false);\n  useEffect(() => {\n    if (!localMaintenanceChanged && transformer !== null && transformer !== void 0 && transformer.maintenanceImage) {\n      setMaintenanceImage(transformer.maintenanceImage);\n      setMaintenanceWeather((transformer === null || transformer === void 0 ? void 0 : transformer.maintenanceWeather) || \"Sunny\");\n      setMaintenanceUploadDate((transformer === null || transformer === void 0 ? void 0 : transformer.maintenanceUploadDate) || null);\n    }\n  }, [transformer, localMaintenanceChanged]);\n  const [maintenanceImageURL, setMaintenanceImageURL] = useState(null);\n  useEffect(() => {\n    if (!maintenanceImage) {\n      setMaintenanceImageURL(null);\n      return;\n    }\n    if (maintenanceImage instanceof File || maintenanceImage instanceof Blob) {\n      const url = URL.createObjectURL(maintenanceImage);\n      setMaintenanceImageURL(url);\n      return () => URL.revokeObjectURL(url);\n    } else {\n      setMaintenanceImageURL(maintenanceImage);\n    }\n  }, [maintenanceImage]);\n  const [showBaselinePreview, setShowBaselinePreview] = useState(false);\n\n  // --- Progress status ---\n  const [progressStatus, setProgressStatus] = useState(inspection.progressStatus || {\n    thermalUpload: inspection.maintenanceImage ? \"Completed\" : \"Pending\",\n    aiAnalysis: inspection.maintenanceImage ? \"In Progress\" : \"Pending\",\n    review: inspection.maintenanceImage ? \"In Progress\" : \"Pending\"\n  });\n\n  // --- Completion ---\n  const [isCompleted, setIsCompleted] = useState(false);\n  const handleComplete = async () => {\n    const updatedInspection = {\n      ...inspection,\n      maintenanceImage,\n      annotatedImage,\n      baselineWeather,\n      baselineUploadDate,\n      maintenanceWeather,\n      maintenanceUploadDate,\n      anomalies,\n      // Then update status to complete\n      status: \"Completed\",\n      inspectedDate: inspection.date,\n      date: null,\n      progressStatus: {\n        thermalUpload: \"Completed\",\n        aiAnalysis: \"Completed\",\n        review: \"Completed\"\n      }\n    };\n    if (updateInspection) updateInspection(updatedInspection);\n    // Now close the modal\n    onClose();\n  };\n\n  // ---------------- AI Analysis + Annotations ----------------\n  const [annotatedImage, setAnnotatedImage] = useState(inspection.annotatedImage || null); // data-uri or url\n  const [anomalies, setAnomalies] = useState(inspection.anomalies || []); // {id,x,y,w,h,confidence,comment,source,deleted}\n  const [isRunningAI, setIsRunningAI] = useState(false);\n  const [aiThreshold, setAiThreshold] = useState(0.5); // New state for AI threshold\n  const [zoomLevel, setZoomLevel] = useState(1); // Re-add state for zoom slider\n  const [imageLoaded, setImageLoaded] = useState(0); // State to trigger re-render on image load\n  const [hoveredAnomalyId, setHoveredAnomalyId] = useState(null); // For highlighting\n  const [selectedAnomalyId, setSelectedAnomalyId] = useState(null); // For editing/resizing\n  const [isResizing, setIsResizing] = useState(false); // Track if user is resizing\n  const [resizeHandle, setResizeHandle] = useState(null); // Which handle is being dragged\n  const [isDragging, setIsDragging] = useState(false); // Track if user is dragging to reposition\n\n  // Auto-save annotations when they change\n  useEffect(() => {\n    const autoSave = async () => {\n      if (anomalies.length > 0 && inspection.id) {\n        try {\n          await fetch(`http://localhost:8000/api/annotations/${inspection.id}`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              annotations: anomalies,\n              user_id: uploader,\n              transformer_id: inspection.transformer\n            })\n          });\n        } catch (error) {\n          console.error('Auto-save failed:', error);\n        }\n      }\n    };\n\n    // Debounce auto-save\n    const timeoutId = setTimeout(autoSave, 1000);\n    return () => clearTimeout(timeoutId);\n  }, [anomalies, inspection.id, inspection.transformer]);\n\n  // Load saved annotations when component mounts\n  useEffect(() => {\n    const loadAnnotations = async () => {\n      if (inspection.id) {\n        try {\n          const response = await fetch(`http://localhost:8000/api/annotations/${inspection.id}`);\n          if (response.ok) {\n            const savedAnnotations = await response.json();\n            if (savedAnnotations.length > 0) {\n              // Convert from database format to UI format\n              const convertedAnnotations = savedAnnotations.map(a => ({\n                id: a.annotation_id,\n                x: a.x,\n                y: a.y,\n                w: a.w,\n                h: a.h,\n                confidence: a.confidence,\n                severity: a.severity,\n                classification: a.classification,\n                comment: a.comment || '',\n                source: a.source,\n                deleted: a.deleted === 1,\n                created_at: a.created_at,\n                updated_at: a.updated_at,\n                user_id: a.user_id\n              }));\n              setAnomalies(convertedAnnotations);\n            }\n          }\n        } catch (error) {\n          console.error('Failed to load annotations:', error);\n        }\n      }\n    };\n    loadAnnotations();\n  }, [inspection.id]);\n\n  // Filter out deleted anomalies for display\n  const visibleAnomalies = anomalies.filter(a => !a.deleted);\n\n  // Canvas / image refs for adding boxes\n  const annotatedImgRef = useRef(null);\n  const annotLayerRef = useRef(null);\n  const [isAddingBox, setIsAddingBox] = useState(false);\n  const [newBoxStart, setNewBoxStart] = useState(null);\n\n  // Helper: convert dataURL to File for upload\n  function dataURLtoFile(dataurl, filename) {\n    if (!dataurl) return null;\n    const arr = dataurl.split(',');\n    const mime = arr[0].match(/:(.*?);/)[1];\n    const bstr = atob(arr[1]);\n    let n = bstr.length;\n    const u8arr = new Uint8Array(n);\n    while (n--) u8arr[n] = bstr.charCodeAt(n);\n    return new File([u8arr], filename, {\n      type: mime\n    });\n  }\n\n  // Edit comment for anomaly\n  const handleCommentChange = (id, text) => {\n    setAnomalies(prev => prev.map(a => a.id === id ? {\n      ...a,\n      comment: text\n    } : a));\n  };\n\n  // Delete (mark deleted) or restore\n  const handleDeleteAnomaly = id => {\n    const anomalyToDelete = anomalies.find(a => a.id === id);\n    if (!anomalyToDelete) return;\n    if (anomalyToDelete.source === 'ai') {\n      // For AI anomalies, a comment (reason) is required for deletion.\n      if (!anomalyToDelete.comment || anomalyToDelete.comment.trim() === '') {\n        alert('Please provide a reason in the \"Comment\" field before deleting an AI-detected anomaly.');\n        return;\n      }\n    }\n    // For both AI (with reason) and Manual anomalies, mark as deleted.\n    setAnomalies(prev => prev.map(a => a.id === id ? {\n      ...a,\n      deleted: true\n    } : a));\n  };\n  const handleRestoreAnomaly = id => {\n    setAnomalies(prev => prev.map(a => a.id === id ? {\n      ...a,\n      deleted: false\n    } : a));\n  };\n\n  // Handle resize/reposition of annotations\n  const handleAnnotationMouseDown = (e, anomalyId, handle = null) => {\n    e.stopPropagation();\n    setSelectedAnomalyId(anomalyId);\n    if (handle) {\n      // Resizing\n      setIsResizing(true);\n      setResizeHandle(handle);\n    } else {\n      // Dragging/repositioning\n      setIsDragging(true);\n    }\n  };\n  const handleAnnotationDrag = e => {\n    if (!isDragging && !isResizing) return;\n    if (!selectedAnomalyId) return;\n    const {\n      x: mouseX,\n      y: mouseY\n    } = getMousePos(e);\n    setAnomalies(prev => prev.map(a => {\n      if (a.id !== selectedAnomalyId) return a;\n      if (isDragging) {\n        // Reposition - move the entire box\n        const newX = mouseX - a.w / 2;\n        const newY = mouseY - a.h / 2;\n        return {\n          ...a,\n          x: Math.max(0, newX),\n          y: Math.max(0, newY)\n        };\n      } else if (isResizing && resizeHandle) {\n        // Resize based on which handle is being dragged\n        const newAnnot = {\n          ...a\n        };\n        switch (resizeHandle) {\n          case 'nw':\n            // top-left\n            newAnnot.w = a.x + a.w - mouseX;\n            newAnnot.h = a.y + a.h - mouseY;\n            newAnnot.x = mouseX;\n            newAnnot.y = mouseY;\n            break;\n          case 'ne':\n            // top-right\n            newAnnot.w = mouseX - a.x;\n            newAnnot.h = a.y + a.h - mouseY;\n            newAnnot.y = mouseY;\n            break;\n          case 'sw':\n            // bottom-left\n            newAnnot.w = a.x + a.w - mouseX;\n            newAnnot.h = mouseY - a.y;\n            newAnnot.x = mouseX;\n            break;\n          case 'se':\n            // bottom-right\n            newAnnot.w = mouseX - a.x;\n            newAnnot.h = mouseY - a.y;\n            break;\n        }\n\n        // Ensure minimum size\n        if (newAnnot.w < 10) newAnnot.w = 10;\n        if (newAnnot.h < 10) newAnnot.h = 10;\n        return newAnnot;\n      }\n      return a;\n    }));\n  };\n  const handleAnnotationMouseUp = () => {\n    setIsDragging(false);\n    setIsResizing(false);\n    setResizeHandle(null);\n  };\n\n  // Add mouse move and mouse up listeners for drag/resize\n  useEffect(() => {\n    if (isDragging || isResizing) {\n      window.addEventListener('mousemove', handleAnnotationDrag);\n      window.addEventListener('mouseup', handleAnnotationMouseUp);\n      return () => {\n        window.removeEventListener('mousemove', handleAnnotationDrag);\n        window.removeEventListener('mouseup', handleAnnotationMouseUp);\n      };\n    }\n  }, [isDragging, isResizing, selectedAnomalyId, resizeHandle]);\n\n  // --- Save handler (will also save annotations if present) ---\n  const handleManualSeverityChange = (id, newSeverity) => {\n    setAnomalies(prev => prev.map(a => a.id === id && a.source === 'user' ? {\n      ...a,\n      severity: newSeverity\n    } : a));\n  };\n  const handleManualClassificationChange = (id, newClassification) => {\n    setAnomalies(prev => prev.map(a => a.id === id && a.source === 'user' ? {\n      ...a,\n      classification: newClassification\n    } : a));\n  };\n  const manualSeverityOptions = [\"Faulty\", \"Potentially Faulty\", \"Normal\"];\n  const manualClassificationOptions = [\"Loose Joint\", \"Point Overload\", \"Full Wire Overload\", \"Other\"];\n  const handleSave = async () => {\n    // Persist inspection info (images & status)\n    if (updateInspection) {\n      updateInspection({\n        ...inspection,\n        maintenanceImage,\n        annotatedImage,\n        // Persist the annotated image\n        baselineWeather,\n        baselineUploadDate,\n        maintenanceWeather,\n        maintenanceUploadDate,\n        progressStatus,\n        anomalies,\n        // Save anomalies\n        inspectedDate: isCompleted ? inspection.date : inspection.inspectedDate,\n        status: progressStatus.thermalUpload === \"Completed\" && isCompleted ? \"Completed\" : inspection.status\n      });\n    }\n\n    // Save annotations to backend\n    if (anomalies && anomalies.length > 0 && inspection.id) {\n      try {\n        await fetch(`http://localhost:8000/api/annotations/${inspection.id}`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            annotations: anomalies,\n            user_id: uploader,\n            transformer_id: inspection.transformer\n          })\n        });\n      } catch (error) {\n        console.error('Failed to save annotations:', error);\n        alert('Failed to save annotations. Please try again.');\n      }\n    }\n    onClose();\n  };\n\n  // --- Upload handlers ---\n  const handleBaselineUpload = e => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        const now = new Date().toLocaleString();\n        setBaselineImage(reader.result);\n        setBaselineUploadDate(now);\n        setLocalBaselineChanged(true);\n        if (updateTransformer && transformer) {\n          updateTransformer({\n            ...transformer,\n            baselineImage: reader.result,\n            baselineUploadDate: now,\n            weather: baselineWeather\n          });\n        }\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  const handleDeleteBaseline = () => {\n    setBaselineImage(null);\n    setBaselineUploadDate(null);\n    setBaselineWeather(\"Sunny\");\n    setLocalBaselineChanged(false);\n    if (updateTransformer && transformer) {\n      updateTransformer({\n        ...transformer,\n        baselineImage: null,\n        baselineUploadDate: null,\n        weather: \"Sunny\"\n      });\n    }\n  };\n  const handleMaintenanceUpload = e => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        const now = new Date().toLocaleString();\n        setMaintenanceImage(reader.result);\n        setLocalMaintenanceChanged(true);\n        setMaintenanceUploadDate(now); // Set the upload date\n        setProgressStatus({\n          thermalUpload: \"Completed\",\n          aiAnalysis: \"Pending\",\n          review: \"Pending\"\n        });\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  // Run AI: POST baseline + maintenance to /analyze\n  const handleRunAI = async () => {\n    if (!baselineImage || !maintenanceImage) {\n      alert(\"Upload both baseline and maintenance images before running AI analysis.\");\n      return;\n    }\n    setIsRunningAI(true);\n    setProgressStatus(prev => ({\n      ...prev,\n      aiAnalysis: \"In Progress\"\n    }));\n    try {\n      const form = new FormData();\n      // backend expects files; convert dataURI to File if necessary\n      const bfile = baselineImage instanceof File ? baselineImage : dataURLtoFile(baselineImage, 'baseline.png');\n      const mfile = maintenanceImage instanceof File ? maintenanceImage : dataURLtoFile(maintenanceImage, 'maintenance.png');\n      form.append('baseline', bfile);\n      form.append('maintenance', mfile);\n      form.append('inspection_id', inspection.id);\n      form.append('threshold', aiThreshold); // Send threshold to backend\n\n      const res = await fetch(\"http://localhost:8000/analyze\", {\n        method: \"POST\",\n        body: form\n      });\n      if (!res.ok) {\n        const txt = await res.text();\n        throw new Error(`AI analyze failed: ${txt}`);\n      }\n      const j = await res.json();\n      // Expect: { annotatedImage: <data-uri or url>, anomalies: [{id,x,y,w,h,confidence,severity}] }\n      // Use the image data URI sent directly from the backend. This is crucial.\n      setAnnotatedImage(j.annotatedImage);\n\n      // map anomalies, ensure ids exist\n      const mapped = (j.anomalies || []).map(a => {\n        var _a$id, _a$confidence, _a$classification, _a$severity, _a$comment;\n        return {\n          id: (_a$id = a.id) !== null && _a$id !== void 0 ? _a$id : `${Date.now()}_${Math.random().toString(36).slice(2, 7)}`,\n          x: a.x,\n          y: a.y,\n          w: a.w,\n          h: a.h,\n          confidence: (_a$confidence = a.confidence) !== null && _a$confidence !== void 0 ? _a$confidence : null,\n          classification: (_a$classification = a.classification) !== null && _a$classification !== void 0 ? _a$classification : 'Unknown',\n          severity: (_a$severity = a.severity) !== null && _a$severity !== void 0 ? _a$severity : null,\n          comment: (_a$comment = a.comment) !== null && _a$comment !== void 0 ? _a$comment : '',\n          source: 'ai',\n          deleted: false\n        };\n      });\n      setAnomalies(mapped);\n      setProgressStatus(prev => ({\n        ...prev,\n        aiAnalysis: \"Completed\",\n        review: \"In Progress\",\n        thermalUpload: \"Completed\"\n      }));\n    } catch (err) {\n      console.error(err);\n      alert(\"AI analysis failed. See console for details.\");\n      setProgressStatus(prev => ({\n        ...prev,\n        aiAnalysis: \"Failed\"\n      }));\n    } finally {\n      setIsRunningAI(false);\n    }\n  };\n\n  // Add manual box (click-drag on annotated image)\n  const getElementOffset = el => {\n    const rect = el.getBoundingClientRect();\n    return {\n      left: rect.left + window.scrollX,\n      top: rect.top + window.scrollY\n    };\n  };\n  const onAnnotatedMouseDown = e => {\n    if (!isAddingBox) return;\n    e.preventDefault(); // This is the key fix: prevent default browser drag behavior.\n    const img = annotatedImgRef.current;\n    if (!img) return;\n    const {\n      x,\n      y\n    } = getMousePos(e);\n    setNewBoxStart({\n      x,\n      y\n    });\n  };\n\n  // Helper to get true mouse position on the image, accounting for object-fit\n  const getMousePos = e => {\n    const img = annotatedImgRef.current;\n    if (!img || !img.naturalWidth) return {\n      x: 0,\n      y: 0\n    }; // Guard against no image\n    const rect = img.getBoundingClientRect();\n\n    // Calculate the scale of the image within its container due to object-fit: contain\n    const scale = Math.min(rect.width / img.naturalWidth, rect.height / img.naturalHeight);\n\n    // Calculate the actual rendered dimensions of the image\n    const renderedWidth = img.naturalWidth * scale;\n    const renderedHeight = img.naturalHeight * scale;\n\n    // Calculate the offset (letterboxing) from the top-left of the container\n    const offsetX = (rect.width - renderedWidth) / 2;\n    const offsetY = (rect.height - renderedHeight) / 2;\n\n    // Get mouse position relative to the actual rendered image\n    const imageX = e.clientX - rect.left - offsetX;\n    const imageY = e.clientY - rect.top - offsetY;\n\n    // Scale the mouse position back to the natural image dimensions\n    return {\n      x: imageX / scale,\n      y: imageY / scale\n    };\n  };\n  const onAnnotatedMouseUp = e => {\n    if (!isAddingBox || !newBoxStart) return;\n    const img = annotatedImgRef.current;\n    if (!img) {\n      setIsAddingBox(false);\n      setNewBoxStart(null);\n      return;\n    }\n    const {\n      x: finalX,\n      y: finalY\n    } = getMousePos(e);\n    const width = Math.abs(finalX - newBoxStart.x);\n    const height = Math.abs(finalY - newBoxStart.y);\n    if (width > 5 && height > 5) {\n      const x = Math.min(newBoxStart.x, finalX);\n      const y = Math.min(newBoxStart.y, finalY);\n      const newAnom = {\n        id: `user_${Date.now()}_${Math.random().toString(36).slice(2, 6)}`,\n        x,\n        y,\n        w: width,\n        h: height,\n        severity: '',\n        // Default empty severity for dropdown\n        classification: '',\n        // Default empty classification for dropdown\n        severity: null,\n        comment: '',\n        source: 'user',\n        deleted: false\n      };\n      setAnomalies(prev => [...prev, newAnom]);\n    }\n    setIsAddingBox(false);\n    setNewBoxStart(null);\n  };\n\n  // Remove all annotations (utility)\n  const handleClearAnnotations = () => {\n    if (!window.confirm(\"Clear all annotations?\")) return;\n    setAnomalies([]);\n  };\n\n  // ---------------- UI Render helpers ----------------\n  const renderStep = (label, state) => {\n    const color = state === \"Completed\" ? \"green\" : state === \"In Progress\" ? \"orange\" : state === \"Failed\" ? \"red\" : \"grey\";\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"progress-step\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"progress-circle\",\n        style: {\n          backgroundColor: color\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 560,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"progress-label\",\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 561,\n          columnNumber: 42\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"progress-status\",\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: state\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 43\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 562,\n        columnNumber: 9\n      }, this)]\n    }, label, true, {\n      fileName: _jsxFileName,\n      lineNumber: 559,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Map anomalies to rendered overlay boxes using absolute positioned divs\n  // Note: we assume backend coordinates are in image pixel coordinates of the annotatedImage\n  const renderAnomalyOverlays = key => {\n    // Add key to ensure re-render when image loads\n    if (!annotatedImage) return null;\n    // We use the naturalWidth/naturalHeight of the <img> to calculate scaling if the displayed size differs\n    const imgEl = annotatedImgRef.current;\n    return visibleAnomalies.map((a, index) => {\n      // This robust logic correctly scales natural coordinates to display coordinates, accounting for object-fit\n      if (!imgEl || !imgEl.naturalWidth) return null;\n      const imgScale = Math.min(imgEl.clientWidth / imgEl.naturalWidth, imgEl.clientHeight / imgEl.naturalHeight);\n      const offsetX = (imgEl.clientWidth - imgEl.naturalWidth * imgScale) / 2;\n      const offsetY = (imgEl.clientHeight - imgEl.naturalHeight * imgScale) / 2;\n      const left = a.x * imgScale + offsetX;\n      const top = a.y * imgScale + offsetY;\n      const width = a.w * imgScale;\n      const height = a.h * imgScale;\n      const borderColor = a.severity === 'Faulty' ? 'rgba(220, 53, 69, 0.9)' : a.severity === 'Potentially Faulty' ? 'rgba(253, 126, 20, 0.9)' : 'rgba(255, 200, 0, 0.95)';\n      const isSelected = selectedAnomalyId === a.id;\n      return (\n        /*#__PURE__*/\n        // The parent div for an annotation box and its label\n        _jsxDEV(\"div\", {\n          className: \"annotation-box\",\n          style: {\n            position: 'absolute',\n            left: `${left}px`,\n            // Scaled coordinates\n            top: `${top}px`,\n            width: `${width}px`,\n            height: `${height}px`,\n            boxSizing: 'border-box',\n            pointerEvents: 'auto',\n            // Enable hover events\n            cursor: isDragging ? 'grabbing' : 'grab'\n          },\n          onMouseEnter: () => setHoveredAnomalyId(a.id),\n          onMouseLeave: () => setHoveredAnomalyId(null),\n          onMouseDown: e => handleAnnotationMouseDown(e, a.id),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '100%',\n              height: '100%',\n              border: `${isSelected ? '3px' : '2px'} solid ${borderColor}`,\n              boxShadow: isSelected ? '0 0 10px rgba(0,0,0,0.5)' : 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 613,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"annotation-tag\",\n            style: {\n              backgroundColor: borderColor\n            },\n            children: index + 1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 621,\n            columnNumber: 11\n          }, this), isSelected && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"resize-handle resize-nw\",\n              style: {\n                position: 'absolute',\n                top: '-4px',\n                left: '-4px',\n                width: '8px',\n                height: '8px',\n                background: 'white',\n                border: '2px solid ' + borderColor,\n                cursor: 'nw-resize',\n                borderRadius: '50%'\n              },\n              onMouseDown: e => handleAnnotationMouseDown(e, a.id, 'nw')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 628,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"resize-handle resize-ne\",\n              style: {\n                position: 'absolute',\n                top: '-4px',\n                right: '-4px',\n                width: '8px',\n                height: '8px',\n                background: 'white',\n                border: '2px solid ' + borderColor,\n                cursor: 'ne-resize',\n                borderRadius: '50%'\n              },\n              onMouseDown: e => handleAnnotationMouseDown(e, a.id, 'ne')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 643,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"resize-handle resize-sw\",\n              style: {\n                position: 'absolute',\n                bottom: '-4px',\n                left: '-4px',\n                width: '8px',\n                height: '8px',\n                background: 'white',\n                border: '2px solid ' + borderColor,\n                cursor: 'sw-resize',\n                borderRadius: '50%'\n              },\n              onMouseDown: e => handleAnnotationMouseDown(e, a.id, 'sw')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 658,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"resize-handle resize-se\",\n              style: {\n                position: 'absolute',\n                bottom: '-4px',\n                right: '-4px',\n                width: '8px',\n                height: '8px',\n                background: 'white',\n                border: '2px solid ' + borderColor,\n                cursor: 'se-resize',\n                borderRadius: '50%'\n              },\n              onMouseDown: e => handleAnnotationMouseDown(e, a.id, 'se')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 673,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true), hoveredAnomalyId === a.id && a.user_id && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute',\n              bottom: '-60px',\n              left: '0',\n              background: 'rgba(0,0,0,0.8)',\n              color: 'white',\n              padding: '4px 8px',\n              borderRadius: '4px',\n              fontSize: '11px',\n              whiteSpace: 'nowrap',\n              pointerEvents: 'none',\n              zIndex: 1000\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"User:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 706,\n                columnNumber: 20\n              }, this), \" \", a.user_id]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 706,\n              columnNumber: 15\n            }, this), a.updated_at && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Modified:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 707,\n                columnNumber: 37\n              }, this), \" \", new Date(a.updated_at).toLocaleString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 707,\n              columnNumber: 32\n            }, this), a.source === 'ai' && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Source:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 708,\n                columnNumber: 42\n              }, this), \" AI Detection\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 708,\n              columnNumber: 37\n            }, this), a.source === 'user' && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Source:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 709,\n                columnNumber: 44\n              }, this), \" Manual\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 709,\n              columnNumber: 39\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 693,\n            columnNumber: 13\n          }, this)]\n        }, a.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 9\n        }, this)\n      );\n    });\n  };\n\n  // ---------------- JSX ----------------\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal-overlay\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"modal-title\",\n        children: \"Thermal Image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 721,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-flex-horizontal\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Transformer Info\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 725,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Number:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 726,\n              columnNumber: 16\n            }, this), \" \", (transformer === null || transformer === void 0 ? void 0 : transformer.number) || \"N/A\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 726,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Pole:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 727,\n              columnNumber: 16\n            }, this), \" \", (transformer === null || transformer === void 0 ? void 0 : transformer.pole) || \"N/A\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 727,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Region:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 728,\n              columnNumber: 16\n            }, this), \" \", (transformer === null || transformer === void 0 ? void 0 : transformer.region) || \"N/A\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 728,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Location:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 729,\n              columnNumber: 16\n            }, this), \" \", (transformer === null || transformer === void 0 ? void 0 : transformer.location) || \"N/A\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 729,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Type:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 730,\n              columnNumber: 16\n            }, this), \" \", (transformer === null || transformer === void 0 ? void 0 : transformer.type) || \"N/A\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 730,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Inspector:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 731,\n              columnNumber: 16\n            }, this), \" \", inspection.inspector || \"N/A\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 731,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Inspection Date:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 732,\n              columnNumber: 16\n            }, this), \" \", inspection.date || \"N/A\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 732,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 724,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Inspection Progress\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 736,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"progress-bar-container\",\n            children: [renderStep(\"Thermal Image Upload\", progressStatus.thermalUpload), renderStep(\"AI Analysis\", progressStatus.aiAnalysis), renderStep(\"Thermal Image Review\", progressStatus.review)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 737,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 735,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 723,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-flex-horizontal\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Baseline Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 747,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"weather-select\",\n            children: /*#__PURE__*/_jsxDEV(\"label\", {\n              children: [\"Weather:\", /*#__PURE__*/_jsxDEV(\"select\", {\n                value: baselineWeather,\n                onChange: e => setBaselineWeather(e.target.value),\n                disabled: !baselineImage,\n                children: weatherOptions.map(w => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: w,\n                  children: w\n                }, w, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 752,\n                  columnNumber: 44\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 751,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 749,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 748,\n            columnNumber: 13\n          }, this), baselineImageURL ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"image-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\uD83D\\uDDBC\\uFE0F Baseline Image uploaded\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 758,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowBaselinePreview(true),\n              children: \"\\uD83D\\uDC41\\uFE0F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 759,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleDeleteBaseline,\n              className: \"danger-btn\",\n              children: \"\\uD83D\\uDDD1\\uFE0F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 760,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 757,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              id: \"baselineUpload\",\n              onChange: handleBaselineUpload,\n              style: {\n                display: \"none\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 764,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"baselineUpload\",\n              className: \"upload-btn\",\n              children: \"\\uD83D\\uDCE4 Upload Baseline Image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 765,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 746,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Thermal Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 771,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            id: \"maintenanceUpload\",\n            onChange: handleMaintenanceUpload,\n            style: {\n              display: \"none\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 772,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"maintenanceUpload\",\n            className: \"upload-btn\",\n            children: \"Upload Thermal Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 773,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              marginTop: 8\n            },\n            children: [\"Weather:\", /*#__PURE__*/_jsxDEV(\"select\", {\n              value: maintenanceWeather,\n              onChange: e => setMaintenanceWeather(e.target.value),\n              style: {\n                marginLeft: 8\n              },\n              children: weatherOptions.map(w => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: w,\n                children: w\n              }, w, false, {\n                fileName: _jsxFileName,\n                lineNumber: 777,\n                columnNumber: 42\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 776,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 774,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 12\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"threshold-slider\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"ai-threshold\",\n                children: [\"Anomaly Detection Threshold: \", Math.round(aiThreshold * 100), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 783,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                id: \"ai-threshold\",\n                min: \"0\",\n                max: \"1\",\n                step: \"0.05\",\n                value: aiThreshold,\n                onChange: e => setAiThreshold(parseFloat(e.target.value))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 784,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 782,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"analysis-btn\",\n              onClick: handleRunAI,\n              disabled: isRunningAI || !baselineImage || !maintenanceImage,\n              children: isRunningAI ? \"Running AI...\" : \"Run AI Analysis\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 791,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: isAddingBox ? \"cancel-draw-btn\" : \"\",\n              style: {\n                marginLeft: 8\n              },\n              onClick: () => {\n                if (isAddingBox) {\n                  setIsAddingBox(false);\n                  setNewBoxStart(null);\n                } else {\n                  setIsAddingBox(true);\n                }\n              },\n              disabled: !annotatedImage,\n              children: isAddingBox ? \"Cancel Drawing\" : \"Add Manual Box\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 798,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                marginLeft: 8\n              },\n              onClick: handleClearAnnotations,\n              children: \"Clear Annotations\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 813,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 781,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 770,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 745,\n        columnNumber: 9\n      }, this), maintenanceImageURL && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-section comparison\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"center-text\",\n          children: annotatedImage ? \"AI Annotated Image Comparison\" : \"Thermal Image Comparison\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 820,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"comparison-flex\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"image-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Baseline Image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 823,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"image-box\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: baselineImageURL,\n                alt: \"Baseline\",\n                style: {\n                  maxWidth: '100%'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 824,\n                columnNumber: 44\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 824,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"image-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Date & Time:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 826,\n                  columnNumber: 22\n                }, this), \" \", baselineUploadDate || \"N/A\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 826,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Weather:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 827,\n                  columnNumber: 22\n                }, this), \" \", baselineWeather]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 827,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Uploader:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 828,\n                  columnNumber: 22\n                }, this), \" \", uploader]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 828,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Image Type:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 829,\n                  columnNumber: 22\n                }, this), \" Baseline\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 829,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 825,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 822,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"image-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: annotatedImage ? \"AI Annotated Image\" : \"Thermal Image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 834,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"image-box\",\n              style: {\n                overflow: 'auto'\n              },\n              children: annotatedImage ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"annotation-container\",\n                style: {\n                  position: 'relative',\n                  transform: `scale(${zoomLevel})`,\n                  transformOrigin: 'top left'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  ref: annotatedImgRef,\n                  src: annotatedImage,\n                  alt: \"Annotated\",\n                  onLoad: () => setImageLoaded(Date.now()),\n                  onMouseDown: onAnnotatedMouseDown,\n                  onMouseUp: onAnnotatedMouseUp,\n                  style: {\n                    display: 'block',\n                    width: '100%',\n                    height: '100%',\n                    objectFit: 'contain'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 845,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  ref: annotLayerRef,\n                  style: {\n                    position: 'absolute',\n                    left: 0,\n                    top: 0,\n                    pointerEvents: 'none',\n                    width: '100%',\n                    height: '100%'\n                  },\n                  children: renderAnomalyOverlays(imageLoaded)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 854,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 837,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n                src: maintenanceImageURL,\n                alt: \"Thermal\",\n                style: {\n                  maxWidth: '100%',\n                  objectFit: 'contain'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 862,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 835,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"image-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Date & Time:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 866,\n                  columnNumber: 22\n                }, this), \" \", inspection.date || \"N/A\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 866,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Weather:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 867,\n                  columnNumber: 22\n                }, this), \" \", maintenanceWeather || \"N/A\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 867,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Uploader:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 868,\n                  columnNumber: 22\n                }, this), \" \", uploader]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 868,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Image Type:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 869,\n                  columnNumber: 22\n                }, this), \" Maintenance\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 869,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 865,\n              columnNumber: 17\n            }, this), annotatedImage && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"zoom-slider-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"zoom-slider\",\n                children: [\"Zoom: \", Math.round(zoomLevel * 100), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 873,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                id: \"zoom-slider\",\n                min: \"1\",\n                max: \"3\",\n                step: \"0.1\",\n                value: zoomLevel,\n                onChange: e => setZoomLevel(parseFloat(e.target.value))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 874,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 872,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 833,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 821,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 819,\n        columnNumber: 11\n      }, this), anomalies.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Analysis Log\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 896,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"log-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"#\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 900,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Source\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 901,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Severity\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 902,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Classification\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 903,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Details\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 904,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Comment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 905,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"User/Time\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 906,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Actions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 907,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 899,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 898,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: visibleAnomalies.map((a, index) => {\n              var _a$severity2;\n              return /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: a.id === hoveredAnomalyId ? 'log-row-highlight' : '',\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: index + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 913,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: a.source === 'ai' ? 'AI' : 'Manual'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 914,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: a.source === 'ai' ? /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `severity-badge ${(_a$severity2 = a.severity) === null || _a$severity2 === void 0 ? void 0 : _a$severity2.toLowerCase()}`,\n                    children: a.severity || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 917,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: a.severity || '',\n                    onChange: e => handleManualSeverityChange(a.id, e.target.value),\n                    className: \"log-classification-select\",\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      disabled: true,\n                      children: \"Select...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 926,\n                      columnNumber: 27\n                    }, this), manualSeverityOptions.map(opt => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: opt,\n                      children: opt\n                    }, opt, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 927,\n                      columnNumber: 61\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 921,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 915,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: a.source === 'ai' ? /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: a.classification || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 933,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: a.classification || '',\n                    onChange: e => handleManualClassificationChange(a.id, e.target.value),\n                    className: \"log-classification-select\",\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      disabled: true,\n                      children: \"Select...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 940,\n                      columnNumber: 27\n                    }, this), manualClassificationOptions.map(opt => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: opt,\n                      children: opt\n                    }, opt, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 941,\n                      columnNumber: 67\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 935,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 931,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      lineHeight: '1.4'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Pos:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 947,\n                        columnNumber: 30\n                      }, this), \" (\", Math.round(a.x), \", \", Math.round(a.y), \")\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 947,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Size:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 948,\n                        columnNumber: 30\n                      }, this), \" \", Math.round(a.w), \"x\", Math.round(a.h), \" px\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 948,\n                      columnNumber: 25\n                    }, this), a.source === 'ai' && /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Conf:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 951,\n                        columnNumber: 29\n                      }, this), \" \", a.confidence ? `${Math.round(a.confidence * 100)}%` : 'N/A']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 950,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 946,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 945,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                    placeholder: \"Add comment...\",\n                    value: a.comment || '',\n                    onChange: e => handleCommentChange(a.id, e.target.value),\n                    className: \"log-comment-textarea\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 957,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 956,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '11px',\n                      lineHeight: '1.3'\n                    },\n                    children: [a.user_id && /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"User:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 966,\n                        columnNumber: 44\n                      }, this), \" \", a.user_id]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 966,\n                      columnNumber: 39\n                    }, this), a.created_at && /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Created:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 967,\n                        columnNumber: 47\n                      }, this), \" \", new Date(a.created_at).toLocaleString()]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 967,\n                      columnNumber: 42\n                    }, this), a.updated_at && /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Updated:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 968,\n                        columnNumber: 47\n                      }, this), \" \", new Date(a.updated_at).toLocaleString()]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 968,\n                      columnNumber: 42\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 965,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 964,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"danger-btn\",\n                    onClick: () => handleDeleteAnomaly(a.id),\n                    children: \"Delete\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 972,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 971,\n                  columnNumber: 21\n                }, this)]\n              }, a.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 912,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 910,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 897,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 895,\n        columnNumber: 11\n      }, this), showBaselinePreview && baselineImageURL && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-card preview-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Baseline Image Preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 986,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: baselineImageURL,\n            alt: \"Baseline Preview\",\n            className: \"preview-image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 987,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowBaselinePreview(false),\n            className: \"inspection-cancel-btn\",\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 988,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 985,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 984,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"inspection-modal-buttons\",\n        style: {\n          marginTop: 12\n        },\n        children: [progressStatus.aiAnalysis === \"Completed\" && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"inspection-complete-btn\",\n          onClick: handleComplete,\n          children: \"Complete Reviewing\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 995,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSave,\n          className: \"inspection-save-btn\",\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"inspection-cancel-btn\",\n          children: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 998,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 993,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 720,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 719,\n    columnNumber: 5\n  }, this);\n}\n_s(InspectionViewModal, \"FFFQF152w5FRvEobuDoIHpoTFyU=\");\n_c = InspectionViewModal;\nvar _c;\n$RefreshReg$(_c, \"InspectionViewModal\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","Fragment","_Fragment","InspectionViewModal","inspection","transformers","onClose","updateInspection","updateTransformer","_s","transformer","find","t","id","uploader","weatherOptions","baselineImage","setBaselineImage","baselineWeather","setBaselineWeather","weather","baselineUploadDate","setBaselineUploadDate","localBaselineChanged","setLocalBaselineChanged","baselineImageURL","setBaselineImageURL","File","Blob","url","URL","createObjectURL","revokeObjectURL","maintenanceImage","setMaintenanceImage","maintenanceWeather","setMaintenanceWeather","maintenanceUploadDate","setMaintenanceUploadDate","localMaintenanceChanged","setLocalMaintenanceChanged","maintenanceImageURL","setMaintenanceImageURL","showBaselinePreview","setShowBaselinePreview","progressStatus","setProgressStatus","thermalUpload","aiAnalysis","review","isCompleted","setIsCompleted","handleComplete","updatedInspection","annotatedImage","anomalies","status","inspectedDate","date","setAnnotatedImage","setAnomalies","isRunningAI","setIsRunningAI","aiThreshold","setAiThreshold","zoomLevel","setZoomLevel","imageLoaded","setImageLoaded","hoveredAnomalyId","setHoveredAnomalyId","selectedAnomalyId","setSelectedAnomalyId","isResizing","setIsResizing","resizeHandle","setResizeHandle","isDragging","setIsDragging","autoSave","length","fetch","method","headers","body","JSON","stringify","annotations","user_id","transformer_id","error","console","timeoutId","setTimeout","clearTimeout","loadAnnotations","response","ok","savedAnnotations","json","convertedAnnotations","map","a","annotation_id","x","y","w","h","confidence","severity","classification","comment","source","deleted","created_at","updated_at","visibleAnomalies","filter","annotatedImgRef","annotLayerRef","isAddingBox","setIsAddingBox","newBoxStart","setNewBoxStart","dataURLtoFile","dataurl","filename","arr","split","mime","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","type","handleCommentChange","text","prev","handleDeleteAnomaly","anomalyToDelete","trim","alert","handleRestoreAnomaly","handleAnnotationMouseDown","e","anomalyId","handle","stopPropagation","handleAnnotationDrag","mouseX","mouseY","getMousePos","newX","newY","Math","max","newAnnot","handleAnnotationMouseUp","window","addEventListener","removeEventListener","handleManualSeverityChange","newSeverity","handleManualClassificationChange","newClassification","manualSeverityOptions","manualClassificationOptions","handleSave","handleBaselineUpload","file","target","files","reader","FileReader","onloadend","now","Date","toLocaleString","result","readAsDataURL","handleDeleteBaseline","handleMaintenanceUpload","handleRunAI","form","FormData","bfile","mfile","append","res","txt","Error","j","mapped","_a$id","_a$confidence","_a$classification","_a$severity","_a$comment","random","toString","slice","err","getElementOffset","el","rect","getBoundingClientRect","left","scrollX","top","scrollY","onAnnotatedMouseDown","preventDefault","img","current","naturalWidth","scale","min","width","height","naturalHeight","renderedWidth","renderedHeight","offsetX","offsetY","imageX","clientX","imageY","clientY","onAnnotatedMouseUp","finalX","finalY","abs","newAnom","handleClearAnnotations","confirm","renderStep","label","state","color","className","children","style","backgroundColor","fileName","_jsxFileName","lineNumber","columnNumber","renderAnomalyOverlays","key","imgEl","index","imgScale","clientWidth","clientHeight","borderColor","isSelected","position","boxSizing","pointerEvents","cursor","onMouseEnter","onMouseLeave","onMouseDown","border","boxShadow","background","borderRadius","right","bottom","padding","fontSize","whiteSpace","zIndex","number","pole","region","location","inspector","value","onChange","disabled","onClick","display","htmlFor","marginTop","marginLeft","round","step","parseFloat","src","alt","maxWidth","overflow","transform","transformOrigin","ref","onLoad","onMouseUp","objectFit","_a$severity2","toLowerCase","opt","lineHeight","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/DELL.000/Desktop/core4/core4/src/components/InspectionViewModal.js"],"sourcesContent":["// InspectionViewModalWithAI.jsx\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport '../style/InspectionViewModal.css';\r\n\r\nexport default function InspectionViewModal({\r\n  inspection,\r\n  transformers,\r\n  onClose,\r\n  updateInspection,\r\n  updateTransformer\r\n}) {\r\n  const transformer = transformers.find(t => t.id === inspection.transformer);\r\n  const uploader = \"Admin\";\r\n  const weatherOptions = [\"Sunny\", \"Rainy\", \"Cloudy\"];\r\n\r\n  // --- Baseline state ---\r\n  const [baselineImage, setBaselineImage] = useState(inspection.baselineImage || transformer?.baselineImage || null);\r\n  const [baselineWeather, setBaselineWeather] = useState(inspection.baselineWeather || transformer?.weather || \"Sunny\");\r\n  const [baselineUploadDate, setBaselineUploadDate] = useState(inspection.baselineUploadDate || transformer?.baselineUploadDate || null);\r\n  const [localBaselineChanged, setLocalBaselineChanged] = useState(false);\r\n  useEffect(() => {\r\n    if (!localBaselineChanged) {\r\n      setBaselineImage(transformer?.baselineImage || null);\r\n      setBaselineWeather(transformer?.weather || \"Sunny\");\r\n      setBaselineUploadDate(transformer?.baselineUploadDate || null);\r\n    }\r\n  }, [transformer, localBaselineChanged]);\r\n\r\n  const [baselineImageURL, setBaselineImageURL] = useState(null);\r\n  useEffect(() => {\r\n    if (!baselineImage) { setBaselineImageURL(null); return; }\r\n    if (baselineImage instanceof File || baselineImage instanceof Blob) {\r\n      const url = URL.createObjectURL(baselineImage);\r\n      setBaselineImageURL(url);\r\n      return () => URL.revokeObjectURL(url);\r\n    } else { setBaselineImageURL(baselineImage); }\r\n  }, [baselineImage]);\r\n\r\n  // --- Maintenance state ---\r\n  const [maintenanceImage, setMaintenanceImage] = useState(inspection.maintenanceImage || null);\r\n  const [maintenanceWeather, setMaintenanceWeather] = useState(inspection.maintenanceWeather || \"Sunny\");\r\n  const [maintenanceUploadDate, setMaintenanceUploadDate] = useState(inspection.maintenanceUploadDate || null);\r\n  const [localMaintenanceChanged, setLocalMaintenanceChanged] = useState(false);\r\n  useEffect(() => {\r\n    if (!localMaintenanceChanged && transformer?.maintenanceImage) {\r\n      setMaintenanceImage(transformer.maintenanceImage);\r\n      setMaintenanceWeather(transformer?.maintenanceWeather || \"Sunny\");\r\n      setMaintenanceUploadDate(transformer?.maintenanceUploadDate || null);\r\n    }\r\n  }, [transformer, localMaintenanceChanged]);\r\n\r\n  const [maintenanceImageURL, setMaintenanceImageURL] = useState(null);\r\n  useEffect(() => {\r\n    if (!maintenanceImage) { setMaintenanceImageURL(null); return; }\r\n    if (maintenanceImage instanceof File || maintenanceImage instanceof Blob) {\r\n      const url = URL.createObjectURL(maintenanceImage);\r\n      setMaintenanceImageURL(url);\r\n      return () => URL.revokeObjectURL(url);\r\n    } else { setMaintenanceImageURL(maintenanceImage); }\r\n  }, [maintenanceImage]);\r\n\r\n  const [showBaselinePreview, setShowBaselinePreview] = useState(false);\r\n\r\n  // --- Progress status ---\r\n  const [progressStatus, setProgressStatus] = useState(\r\n    inspection.progressStatus || {\r\n      thermalUpload: inspection.maintenanceImage ? \"Completed\" : \"Pending\",\r\n      aiAnalysis: inspection.maintenanceImage ? \"In Progress\" : \"Pending\",\r\n      review: inspection.maintenanceImage ? \"In Progress\" : \"Pending\"\r\n    }\r\n  );\r\n\r\n  // --- Completion ---\r\n  const [isCompleted, setIsCompleted] = useState(false);\r\n  const handleComplete = async () => {\r\n    const updatedInspection = {\r\n      ...inspection,\r\n      maintenanceImage,\r\n      annotatedImage,\r\n      baselineWeather,\r\n      baselineUploadDate,\r\n      maintenanceWeather,\r\n      maintenanceUploadDate,\r\n      anomalies,\r\n      // Then update status to complete\r\n      status: \"Completed\",\r\n      inspectedDate: inspection.date,\r\n      date: null,\r\n      progressStatus: {\r\n        thermalUpload: \"Completed\",\r\n        aiAnalysis: \"Completed\",\r\n        review: \"Completed\",\r\n      },\r\n    };\r\n    if (updateInspection) updateInspection(updatedInspection);\r\n    // Now close the modal\r\n    onClose();\r\n  };\r\n\r\n  // ---------------- AI Analysis + Annotations ----------------\r\n  const [annotatedImage, setAnnotatedImage] = useState(inspection.annotatedImage || null); // data-uri or url\r\n  const [anomalies, setAnomalies] = useState(inspection.anomalies || []); // {id,x,y,w,h,confidence,comment,source,deleted}\r\n  const [isRunningAI, setIsRunningAI] = useState(false);\r\n  const [aiThreshold, setAiThreshold] = useState(0.5); // New state for AI threshold\r\n  const [zoomLevel, setZoomLevel] = useState(1); // Re-add state for zoom slider\r\n  const [imageLoaded, setImageLoaded] = useState(0); // State to trigger re-render on image load\r\n  const [hoveredAnomalyId, setHoveredAnomalyId] = useState(null); // For highlighting\r\n  const [selectedAnomalyId, setSelectedAnomalyId] = useState(null); // For editing/resizing\r\n  const [isResizing, setIsResizing] = useState(false); // Track if user is resizing\r\n  const [resizeHandle, setResizeHandle] = useState(null); // Which handle is being dragged\r\n  const [isDragging, setIsDragging] = useState(false); // Track if user is dragging to reposition\r\n\r\n  // Auto-save annotations when they change\r\n  useEffect(() => {\r\n    const autoSave = async () => {\r\n      if (anomalies.length > 0 && inspection.id) {\r\n        try {\r\n          await fetch(`http://localhost:8000/api/annotations/${inspection.id}`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n              annotations: anomalies,\r\n              user_id: uploader,\r\n              transformer_id: inspection.transformer\r\n            })\r\n          });\r\n        } catch (error) {\r\n          console.error('Auto-save failed:', error);\r\n        }\r\n      }\r\n    };\r\n    \r\n    // Debounce auto-save\r\n    const timeoutId = setTimeout(autoSave, 1000);\r\n    return () => clearTimeout(timeoutId);\r\n  }, [anomalies, inspection.id, inspection.transformer]);\r\n\r\n  // Load saved annotations when component mounts\r\n  useEffect(() => {\r\n    const loadAnnotations = async () => {\r\n      if (inspection.id) {\r\n        try {\r\n          const response = await fetch(`http://localhost:8000/api/annotations/${inspection.id}`);\r\n          if (response.ok) {\r\n            const savedAnnotations = await response.json();\r\n            if (savedAnnotations.length > 0) {\r\n              // Convert from database format to UI format\r\n              const convertedAnnotations = savedAnnotations.map(a => ({\r\n                id: a.annotation_id,\r\n                x: a.x,\r\n                y: a.y,\r\n                w: a.w,\r\n                h: a.h,\r\n                confidence: a.confidence,\r\n                severity: a.severity,\r\n                classification: a.classification,\r\n                comment: a.comment || '',\r\n                source: a.source,\r\n                deleted: a.deleted === 1,\r\n                created_at: a.created_at,\r\n                updated_at: a.updated_at,\r\n                user_id: a.user_id\r\n              }));\r\n              setAnomalies(convertedAnnotations);\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('Failed to load annotations:', error);\r\n        }\r\n      }\r\n    };\r\n    \r\n    loadAnnotations();\r\n  }, [inspection.id]);\r\n\r\n  // Filter out deleted anomalies for display\r\n  const visibleAnomalies = anomalies.filter(a => !a.deleted);\r\n\r\n  // Canvas / image refs for adding boxes\r\n  const annotatedImgRef = useRef(null);\r\n  const annotLayerRef = useRef(null);\r\n  const [isAddingBox, setIsAddingBox] = useState(false);\r\n  const [newBoxStart, setNewBoxStart] = useState(null);\r\n\r\n  // Helper: convert dataURL to File for upload\r\n  function dataURLtoFile(dataurl, filename) {\r\n    if (!dataurl) return null;\r\n    const arr = dataurl.split(',');\r\n    const mime = arr[0].match(/:(.*?);/)[1];\r\n    const bstr = atob(arr[1]);\r\n    let n = bstr.length;\r\n    const u8arr = new Uint8Array(n);\r\n    while (n--) u8arr[n] = bstr.charCodeAt(n);\r\n    return new File([u8arr], filename, { type: mime });\r\n  }\r\n\r\n  // Edit comment for anomaly\r\n  const handleCommentChange = (id, text) => {\r\n    setAnomalies(prev => prev.map(a => a.id === id ? { ...a, comment: text } : a));\r\n  };\r\n\r\n  // Delete (mark deleted) or restore\r\n  const handleDeleteAnomaly = (id) => {\r\n    const anomalyToDelete = anomalies.find(a => a.id === id);\r\n    if (!anomalyToDelete) return;\r\n\r\n    if (anomalyToDelete.source === 'ai') {\r\n      // For AI anomalies, a comment (reason) is required for deletion.\r\n      if (!anomalyToDelete.comment || anomalyToDelete.comment.trim() === '') {\r\n        alert('Please provide a reason in the \"Comment\" field before deleting an AI-detected anomaly.');\r\n        return;\r\n      }\r\n    }\r\n    // For both AI (with reason) and Manual anomalies, mark as deleted.\r\n    setAnomalies(prev => prev.map(a => a.id === id ? { ...a, deleted: true } : a));\r\n  };\r\n  \r\n  const handleRestoreAnomaly = (id) => {\r\n    setAnomalies(prev => prev.map(a => a.id === id ? { ...a, deleted: false } : a));\r\n  };\r\n\r\n  // Handle resize/reposition of annotations\r\n  const handleAnnotationMouseDown = (e, anomalyId, handle = null) => {\r\n    e.stopPropagation();\r\n    setSelectedAnomalyId(anomalyId);\r\n    \r\n    if (handle) {\r\n      // Resizing\r\n      setIsResizing(true);\r\n      setResizeHandle(handle);\r\n    } else {\r\n      // Dragging/repositioning\r\n      setIsDragging(true);\r\n    }\r\n  };\r\n\r\n  const handleAnnotationDrag = (e) => {\r\n    if (!isDragging && !isResizing) return;\r\n    if (!selectedAnomalyId) return;\r\n\r\n    const { x: mouseX, y: mouseY } = getMousePos(e);\r\n    \r\n    setAnomalies(prev => prev.map(a => {\r\n      if (a.id !== selectedAnomalyId) return a;\r\n      \r\n      if (isDragging) {\r\n        // Reposition - move the entire box\r\n        const newX = mouseX - a.w / 2;\r\n        const newY = mouseY - a.h / 2;\r\n        return { ...a, x: Math.max(0, newX), y: Math.max(0, newY) };\r\n      } else if (isResizing && resizeHandle) {\r\n        // Resize based on which handle is being dragged\r\n        const newAnnot = { ...a };\r\n        \r\n        switch(resizeHandle) {\r\n          case 'nw': // top-left\r\n            newAnnot.w = a.x + a.w - mouseX;\r\n            newAnnot.h = a.y + a.h - mouseY;\r\n            newAnnot.x = mouseX;\r\n            newAnnot.y = mouseY;\r\n            break;\r\n          case 'ne': // top-right\r\n            newAnnot.w = mouseX - a.x;\r\n            newAnnot.h = a.y + a.h - mouseY;\r\n            newAnnot.y = mouseY;\r\n            break;\r\n          case 'sw': // bottom-left\r\n            newAnnot.w = a.x + a.w - mouseX;\r\n            newAnnot.h = mouseY - a.y;\r\n            newAnnot.x = mouseX;\r\n            break;\r\n          case 'se': // bottom-right\r\n            newAnnot.w = mouseX - a.x;\r\n            newAnnot.h = mouseY - a.y;\r\n            break;\r\n        }\r\n        \r\n        // Ensure minimum size\r\n        if (newAnnot.w < 10) newAnnot.w = 10;\r\n        if (newAnnot.h < 10) newAnnot.h = 10;\r\n        \r\n        return newAnnot;\r\n      }\r\n      \r\n      return a;\r\n    }));\r\n  };\r\n\r\n  const handleAnnotationMouseUp = () => {\r\n    setIsDragging(false);\r\n    setIsResizing(false);\r\n    setResizeHandle(null);\r\n  };\r\n\r\n  // Add mouse move and mouse up listeners for drag/resize\r\n  useEffect(() => {\r\n    if (isDragging || isResizing) {\r\n      window.addEventListener('mousemove', handleAnnotationDrag);\r\n      window.addEventListener('mouseup', handleAnnotationMouseUp);\r\n      \r\n      return () => {\r\n        window.removeEventListener('mousemove', handleAnnotationDrag);\r\n        window.removeEventListener('mouseup', handleAnnotationMouseUp);\r\n      };\r\n    }\r\n  }, [isDragging, isResizing, selectedAnomalyId, resizeHandle]);\r\n  \r\n  // --- Save handler (will also save annotations if present) ---\r\n  const handleManualSeverityChange = (id, newSeverity) => {\r\n    setAnomalies(prev => prev.map(a =>\r\n        (a.id === id && a.source === 'user')\r\n            ? { ...a, severity: newSeverity }\r\n            : a\r\n    ));\r\n  };\r\n  const handleManualClassificationChange = (id, newClassification) => {\r\n    setAnomalies(prev => prev.map(a =>\r\n        (a.id === id && a.source === 'user')\r\n            ? { ...a, classification: newClassification }\r\n            : a\r\n    ));\r\n  };\r\n  const manualSeverityOptions = [\"Faulty\", \"Potentially Faulty\", \"Normal\"];\r\n  const manualClassificationOptions = [\"Loose Joint\", \"Point Overload\", \"Full Wire Overload\", \"Other\"];\r\n\r\n  const handleSave = async () => {\r\n    // Persist inspection info (images & status)\r\n    if (updateInspection) {\r\n      updateInspection({\r\n        ...inspection,\r\n        maintenanceImage,\r\n        annotatedImage, // Persist the annotated image\r\n        baselineWeather,\r\n        baselineUploadDate,\r\n        maintenanceWeather,\r\n        maintenanceUploadDate,\r\n        progressStatus,\r\n        anomalies, // Save anomalies\r\n        inspectedDate: isCompleted ? inspection.date : inspection.inspectedDate,\r\n        status: progressStatus.thermalUpload === \"Completed\" && isCompleted ? \"Completed\" : inspection.status\r\n      });\r\n    }\r\n\r\n    // Save annotations to backend\r\n    if (anomalies && anomalies.length > 0 && inspection.id) {\r\n      try {\r\n        await fetch(`http://localhost:8000/api/annotations/${inspection.id}`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            annotations: anomalies,\r\n            user_id: uploader,\r\n            transformer_id: inspection.transformer\r\n          })\r\n        });\r\n      } catch (error) {\r\n        console.error('Failed to save annotations:', error);\r\n        alert('Failed to save annotations. Please try again.');\r\n      }\r\n    }\r\n\r\n    onClose();\r\n  };\r\n\r\n  // --- Upload handlers ---\r\n  const handleBaselineUpload = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        const now = new Date().toLocaleString();\r\n        setBaselineImage(reader.result);\r\n        setBaselineUploadDate(now);\r\n        setLocalBaselineChanged(true);\r\n        if (updateTransformer && transformer) {\r\n          updateTransformer({\r\n            ...transformer,\r\n            baselineImage: reader.result,\r\n            baselineUploadDate: now,\r\n            weather: baselineWeather\r\n          });\r\n        }\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n  const handleDeleteBaseline = () => {\r\n    setBaselineImage(null);\r\n    setBaselineUploadDate(null);\r\n    setBaselineWeather(\"Sunny\");\r\n    setLocalBaselineChanged(false);\r\n    if (updateTransformer && transformer) {\r\n      updateTransformer({\r\n        ...transformer,\r\n        baselineImage: null,\r\n        baselineUploadDate: null,\r\n        weather: \"Sunny\",\r\n      });\r\n    }\r\n  };\r\n  const handleMaintenanceUpload = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        const now = new Date().toLocaleString();\r\n        setMaintenanceImage(reader.result);\r\n        setLocalMaintenanceChanged(true);\r\n        setMaintenanceUploadDate(now); // Set the upload date\r\n        setProgressStatus({\r\n          thermalUpload: \"Completed\",\r\n          aiAnalysis: \"Pending\",\r\n          review: \"Pending\"\r\n        });\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  // Run AI: POST baseline + maintenance to /analyze\r\n  const handleRunAI = async () => {\r\n    if (!baselineImage || !maintenanceImage) {\r\n      alert(\"Upload both baseline and maintenance images before running AI analysis.\");\r\n      return;\r\n    }\r\n    setIsRunningAI(true);\r\n    setProgressStatus(prev => ({ ...prev, aiAnalysis: \"In Progress\" }));\r\n\r\n    try {\r\n      const form = new FormData();\r\n      // backend expects files; convert dataURI to File if necessary\r\n      const bfile = baselineImage instanceof File ? baselineImage : dataURLtoFile(baselineImage, 'baseline.png');\r\n      const mfile = maintenanceImage instanceof File ? maintenanceImage : dataURLtoFile(maintenanceImage, 'maintenance.png');\r\n      form.append('baseline', bfile);\r\n      form.append('maintenance', mfile);\r\n      form.append('inspection_id', inspection.id);\r\n      form.append('threshold', aiThreshold); // Send threshold to backend\r\n\r\n      const res = await fetch(\"http://localhost:8000/analyze\", {\r\n        method: \"POST\",\r\n        body: form\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const txt = await res.text();\r\n        throw new Error(`AI analyze failed: ${txt}`);\r\n      }\r\n\r\n      const j = await res.json();\r\n      // Expect: { annotatedImage: <data-uri or url>, anomalies: [{id,x,y,w,h,confidence,severity}] }\r\n      // Use the image data URI sent directly from the backend. This is crucial.\r\n      setAnnotatedImage(j.annotatedImage);\r\n\r\n      // map anomalies, ensure ids exist\r\n      const mapped = (j.anomalies || []).map(a => ({\r\n        id: a.id ?? `${Date.now()}_${Math.random().toString(36).slice(2,7)}`,\r\n        x: a.x, y: a.y, w: a.w, h: a.h,\r\n        confidence: a.confidence ?? null,\r\n        classification: a.classification ?? 'Unknown',\r\n        severity: a.severity ?? null,\r\n        comment: a.comment ?? '',\r\n        source: 'ai',\r\n        deleted: false\r\n      }));\r\n      setAnomalies(mapped);\r\n      setProgressStatus(prev => ({ ...prev, aiAnalysis: \"Completed\", review: \"In Progress\", thermalUpload: \"Completed\" }));\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"AI analysis failed. See console for details.\");\r\n      setProgressStatus(prev => ({ ...prev, aiAnalysis: \"Failed\" }));\r\n    } finally {\r\n      setIsRunningAI(false);\r\n    }\r\n  };\r\n\r\n  // Add manual box (click-drag on annotated image)\r\n  const getElementOffset = (el) => {\r\n    const rect = el.getBoundingClientRect();\r\n    return { left: rect.left + window.scrollX, top: rect.top + window.scrollY };\r\n  };\r\n\r\n  const onAnnotatedMouseDown = (e) => {\r\n    if (!isAddingBox) return;\r\n    e.preventDefault(); // This is the key fix: prevent default browser drag behavior.\r\n    const img = annotatedImgRef.current;\r\n    if (!img) return;\r\n\r\n    const { x, y } = getMousePos(e);\r\n    setNewBoxStart({ x, y });\r\n  };\r\n\r\n  // Helper to get true mouse position on the image, accounting for object-fit\r\n  const getMousePos = (e) => {\r\n    const img = annotatedImgRef.current;\r\n    if (!img || !img.naturalWidth) return { x: 0, y: 0 }; // Guard against no image\r\n    const rect = img.getBoundingClientRect();\r\n\r\n    // Calculate the scale of the image within its container due to object-fit: contain\r\n    const scale = Math.min(\r\n      rect.width / img.naturalWidth,\r\n      rect.height / img.naturalHeight\r\n    );\r\n\r\n    // Calculate the actual rendered dimensions of the image\r\n    const renderedWidth = img.naturalWidth * scale;\r\n    const renderedHeight = img.naturalHeight * scale;\r\n\r\n    // Calculate the offset (letterboxing) from the top-left of the container\r\n    const offsetX = (rect.width - renderedWidth) / 2;\r\n    const offsetY = (rect.height - renderedHeight) / 2;\r\n\r\n    // Get mouse position relative to the actual rendered image\r\n    const imageX = e.clientX - rect.left - offsetX;\r\n    const imageY = e.clientY - rect.top - offsetY;\r\n\r\n    // Scale the mouse position back to the natural image dimensions\r\n    return { x: imageX / scale, y: imageY / scale };\r\n  };\r\n\r\n  const onAnnotatedMouseUp = (e) => {\r\n    if (!isAddingBox || !newBoxStart) return;\r\n    const img = annotatedImgRef.current;\r\n    if (!img) { setIsAddingBox(false); setNewBoxStart(null); return; }\r\n\r\n    const { x: finalX, y: finalY } = getMousePos(e);\r\n\r\n    const width = Math.abs(finalX - newBoxStart.x);\r\n    const height = Math.abs(finalY - newBoxStart.y);\r\n\r\n    if (width > 5 && height > 5) {\r\n      const x = Math.min(newBoxStart.x, finalX);\r\n      const y = Math.min(newBoxStart.y, finalY);\r\n      const newAnom = {\r\n        id: `user_${Date.now()}_${Math.random().toString(36).slice(2,6)}`,\r\n        x, y, w: width, h: height,\r\n        severity: '', // Default empty severity for dropdown\r\n        classification: '', // Default empty classification for dropdown\r\n        severity: null,\r\n        comment: '',\r\n        source: 'user',\r\n        deleted: false\r\n      };\r\n      setAnomalies(prev => [...prev, newAnom]);\r\n    }\r\n    setIsAddingBox(false);\r\n    setNewBoxStart(null);\r\n  };\r\n\r\n  // Remove all annotations (utility)\r\n  const handleClearAnnotations = () => {\r\n    if (!window.confirm(\"Clear all annotations?\")) return;\r\n    setAnomalies([]);\r\n  };\r\n\r\n  // ---------------- UI Render helpers ----------------\r\n  const renderStep = (label, state) => {\r\n    const color = state === \"Completed\" ? \"green\" : state === \"In Progress\" ? \"orange\" : state === \"Failed\" ? \"red\" : \"grey\";\r\n    return (\r\n      <div className=\"progress-step\" key={label}>\r\n        <div className=\"progress-circle\" style={{ backgroundColor: color }}></div>\r\n        <span className=\"progress-label\"><strong>{label}</strong></span>\r\n        <span className=\"progress-status\"><strong>{state}</strong></span>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Map anomalies to rendered overlay boxes using absolute positioned divs\r\n  // Note: we assume backend coordinates are in image pixel coordinates of the annotatedImage\r\n  const renderAnomalyOverlays = (key) => { // Add key to ensure re-render when image loads\r\n    if (!annotatedImage) return null;\r\n    // We use the naturalWidth/naturalHeight of the <img> to calculate scaling if the displayed size differs\r\n    const imgEl = annotatedImgRef.current;\r\n    return visibleAnomalies.map((a, index) => {\r\n      // This robust logic correctly scales natural coordinates to display coordinates, accounting for object-fit\r\n      if (!imgEl || !imgEl.naturalWidth) return null;\r\n\r\n      const imgScale = Math.min(\r\n        imgEl.clientWidth / imgEl.naturalWidth,\r\n        imgEl.clientHeight / imgEl.naturalHeight\r\n      );\r\n\r\n      const offsetX = (imgEl.clientWidth - (imgEl.naturalWidth * imgScale)) / 2;\r\n      const offsetY = (imgEl.clientHeight - (imgEl.naturalHeight * imgScale)) / 2;\r\n\r\n      const left = (a.x * imgScale) + offsetX;\r\n      const top = (a.y * imgScale) + offsetY;\r\n      const width = a.w * imgScale;\r\n      const height = a.h * imgScale;\r\n\r\n      const borderColor = a.severity === 'Faulty' ? 'rgba(220, 53, 69, 0.9)' : (a.severity === 'Potentially Faulty' ? 'rgba(253, 126, 20, 0.9)' : 'rgba(255, 200, 0, 0.95)');\r\n      const isSelected = selectedAnomalyId === a.id;\r\n      \r\n      return (\r\n        // The parent div for an annotation box and its label\r\n        <div\r\n          key={a.id}\r\n          className=\"annotation-box\"\r\n          style={{\r\n            position: 'absolute',\r\n            left: `${left}px`, // Scaled coordinates\r\n            top: `${top}px`,\r\n            width: `${width}px`,\r\n            height: `${height}px`,\r\n            boxSizing: 'border-box',\r\n            pointerEvents: 'auto', // Enable hover events\r\n            cursor: isDragging ? 'grabbing' : 'grab'\r\n          }}\r\n          onMouseEnter={() => setHoveredAnomalyId(a.id)}\r\n          onMouseLeave={() => setHoveredAnomalyId(null)}\r\n          onMouseDown={(e) => handleAnnotationMouseDown(e, a.id)}\r\n        >\r\n          {/* The visible box */}\r\n          <div style={{ \r\n            width: '100%', \r\n            height: '100%', \r\n            border: `${isSelected ? '3px' : '2px'} solid ${borderColor}`,\r\n            boxShadow: isSelected ? '0 0 10px rgba(0,0,0,0.5)' : 'none'\r\n          }} />\r\n          \r\n          {/* The number label */}\r\n          <div className=\"annotation-tag\" style={{ backgroundColor: borderColor }}>\r\n            {index + 1}\r\n          </div>\r\n          \r\n          {/* Resize handles - only show when selected */}\r\n          {isSelected && (\r\n            <>\r\n              <div \r\n                className=\"resize-handle resize-nw\" \r\n                style={{\r\n                  position: 'absolute',\r\n                  top: '-4px',\r\n                  left: '-4px',\r\n                  width: '8px',\r\n                  height: '8px',\r\n                  background: 'white',\r\n                  border: '2px solid ' + borderColor,\r\n                  cursor: 'nw-resize',\r\n                  borderRadius: '50%'\r\n                }}\r\n                onMouseDown={(e) => handleAnnotationMouseDown(e, a.id, 'nw')}\r\n              />\r\n              <div \r\n                className=\"resize-handle resize-ne\"\r\n                style={{\r\n                  position: 'absolute',\r\n                  top: '-4px',\r\n                  right: '-4px',\r\n                  width: '8px',\r\n                  height: '8px',\r\n                  background: 'white',\r\n                  border: '2px solid ' + borderColor,\r\n                  cursor: 'ne-resize',\r\n                  borderRadius: '50%'\r\n                }}\r\n                onMouseDown={(e) => handleAnnotationMouseDown(e, a.id, 'ne')}\r\n              />\r\n              <div \r\n                className=\"resize-handle resize-sw\"\r\n                style={{\r\n                  position: 'absolute',\r\n                  bottom: '-4px',\r\n                  left: '-4px',\r\n                  width: '8px',\r\n                  height: '8px',\r\n                  background: 'white',\r\n                  border: '2px solid ' + borderColor,\r\n                  cursor: 'sw-resize',\r\n                  borderRadius: '50%'\r\n                }}\r\n                onMouseDown={(e) => handleAnnotationMouseDown(e, a.id, 'sw')}\r\n              />\r\n              <div \r\n                className=\"resize-handle resize-se\"\r\n                style={{\r\n                  position: 'absolute',\r\n                  bottom: '-4px',\r\n                  right: '-4px',\r\n                  width: '8px',\r\n                  height: '8px',\r\n                  background: 'white',\r\n                  border: '2px solid ' + borderColor,\r\n                  cursor: 'se-resize',\r\n                  borderRadius: '50%'\r\n                }}\r\n                onMouseDown={(e) => handleAnnotationMouseDown(e, a.id, 'se')}\r\n              />\r\n            </>\r\n          )}\r\n          \r\n          {/* Display metadata when hovered */}\r\n          {hoveredAnomalyId === a.id && a.user_id && (\r\n            <div style={{\r\n              position: 'absolute',\r\n              bottom: '-60px',\r\n              left: '0',\r\n              background: 'rgba(0,0,0,0.8)',\r\n              color: 'white',\r\n              padding: '4px 8px',\r\n              borderRadius: '4px',\r\n              fontSize: '11px',\r\n              whiteSpace: 'nowrap',\r\n              pointerEvents: 'none',\r\n              zIndex: 1000\r\n            }}>\r\n              <div><strong>User:</strong> {a.user_id}</div>\r\n              {a.updated_at && <div><strong>Modified:</strong> {new Date(a.updated_at).toLocaleString()}</div>}\r\n              {a.source === 'ai' && <div><strong>Source:</strong> AI Detection</div>}\r\n              {a.source === 'user' && <div><strong>Source:</strong> Manual</div>}\r\n            </div>\r\n          )}\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  // ---------------- JSX ----------------\r\n  return (\r\n    <div className=\"modal-overlay\">\r\n      <div className=\"modal-card\">\r\n        <h1 className=\"modal-title\">Thermal Image</h1>\r\n\r\n        <div className=\"modal-flex-horizontal\">\r\n          <div className=\"modal-section\">\r\n            <h3>Transformer Info</h3>\r\n            <p><strong>Number:</strong> {transformer?.number || \"N/A\"}</p>\r\n            <p><strong>Pole:</strong> {transformer?.pole || \"N/A\"}</p>\r\n            <p><strong>Region:</strong> {transformer?.region || \"N/A\"}</p>\r\n            <p><strong>Location:</strong> {transformer?.location || \"N/A\"}</p>\r\n            <p><strong>Type:</strong> {transformer?.type || \"N/A\"}</p>\r\n            <p><strong>Inspector:</strong> {inspection.inspector || \"N/A\"}</p>\r\n            <p><strong>Inspection Date:</strong> {inspection.date || \"N/A\"}</p>\r\n          </div>\r\n\r\n          <div className=\"modal-section\">\r\n            <h3>Inspection Progress</h3>\r\n            <div className=\"progress-bar-container\">\r\n              {renderStep(\"Thermal Image Upload\", progressStatus.thermalUpload)}\r\n              {renderStep(\"AI Analysis\", progressStatus.aiAnalysis)}\r\n              {renderStep(\"Thermal Image Review\", progressStatus.review)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"modal-flex-horizontal\">\r\n          <div className=\"modal-section\">\r\n            <h3>Baseline Image</h3>\r\n            <div className=\"weather-select\">\r\n              <label>\r\n                Weather:\r\n                <select value={baselineWeather} onChange={e => setBaselineWeather(e.target.value)} disabled={!baselineImage}>\r\n                  {weatherOptions.map(w => <option key={w} value={w}>{w}</option>)}\r\n                </select>\r\n              </label>\r\n            </div>\r\n            {baselineImageURL ? (\r\n              <div className=\"image-actions\">\r\n                <span>🖼️ Baseline Image uploaded</span>\r\n                <button onClick={() => setShowBaselinePreview(true)}>👁️</button>\r\n                <button onClick={handleDeleteBaseline} className=\"danger-btn\">🗑️</button>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <input type=\"file\" id=\"baselineUpload\" onChange={handleBaselineUpload} style={{ display: \"none\" }} />\r\n                <label htmlFor=\"baselineUpload\" className=\"upload-btn\">📤 Upload Baseline Image</label>\r\n              </>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"modal-section\">\r\n            <h3>Thermal Image</h3>\r\n            <input type=\"file\" id=\"maintenanceUpload\" onChange={handleMaintenanceUpload} style={{ display: \"none\" }} />\r\n            <label htmlFor=\"maintenanceUpload\" className=\"upload-btn\">Upload Thermal Image</label>\r\n            <label style={{ display: 'block', marginTop: 8 }}>\r\n              Weather:\r\n              <select value={maintenanceWeather} onChange={e => setMaintenanceWeather(e.target.value)} style={{ marginLeft: 8 }}>\r\n                {weatherOptions.map(w => <option key={w} value={w}>{w}</option>)}\r\n              </select>\r\n            </label>\r\n\r\n            <div style={{ marginTop: 12 }}>\r\n              <div className=\"threshold-slider\">\r\n                <label htmlFor=\"ai-threshold\">Anomaly Detection Threshold: {Math.round(aiThreshold * 100)}%</label>\r\n                <input\r\n                  type=\"range\"\r\n                  id=\"ai-threshold\"\r\n                  min=\"0\" max=\"1\" step=\"0.05\"\r\n                  value={aiThreshold}\r\n                  onChange={e => setAiThreshold(parseFloat(e.target.value))} />\r\n              </div>\r\n              <button\r\n                className=\"analysis-btn\"\r\n                onClick={handleRunAI}\r\n                disabled={isRunningAI || !baselineImage || !maintenanceImage}\r\n              >\r\n                {isRunningAI ? \"Running AI...\" : \"Run AI Analysis\"}\r\n              </button>\r\n              <button\r\n                className={isAddingBox ? \"cancel-draw-btn\" : \"\"}\r\n                style={{ marginLeft: 8 }}\r\n                onClick={() => {\r\n                  if (isAddingBox) {\r\n                    setIsAddingBox(false);\r\n                    setNewBoxStart(null);\r\n                  } else {\r\n                    setIsAddingBox(true);\r\n                  }\r\n                }}\r\n                disabled={!annotatedImage}\r\n              >\r\n                {isAddingBox ? \"Cancel Drawing\" : \"Add Manual Box\"}\r\n              </button>\r\n              <button style={{ marginLeft: 8 }} onClick={handleClearAnnotations}>Clear Annotations</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {maintenanceImageURL && (\r\n          <div className=\"modal-section comparison\">\r\n            <h3 className=\"center-text\">{annotatedImage ? \"AI Annotated Image Comparison\" : \"Thermal Image Comparison\"}</h3>\r\n            <div className=\"comparison-flex\">\r\n              <div className=\"image-card\">\r\n                <h4>Baseline Image</h4> \r\n                <div className=\"image-box\"><img src={baselineImageURL} alt=\"Baseline\" style={{ maxWidth: '100%' }} /></div>\r\n                <div className=\"image-info\">\r\n                  <p><strong>Date & Time:</strong> {baselineUploadDate || \"N/A\"}</p>\r\n                  <p><strong>Weather:</strong> {baselineWeather}</p>\r\n                  <p><strong>Uploader:</strong> {uploader}</p>\r\n                  <p><strong>Image Type:</strong> Baseline</p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"image-card\">\r\n                <h4>{annotatedImage ? \"AI Annotated Image\" : \"Thermal Image\"}</h4>\r\n                <div className=\"image-box\" style={{ overflow: 'auto' }}>\r\n                  {annotatedImage ? (\r\n                    <div\r\n                      className=\"annotation-container\"\r\n                      style={{\r\n                        position: 'relative',\r\n                        transform: `scale(${zoomLevel})`,\r\n                        transformOrigin: 'top left',\r\n                      }}\r\n                    >\r\n                      <img\r\n                        ref={annotatedImgRef}\r\n                        src={annotatedImage}\r\n                        alt=\"Annotated\"\r\n                        onLoad={() => setImageLoaded(Date.now())}\r\n                        onMouseDown={onAnnotatedMouseDown}\r\n                        onMouseUp={onAnnotatedMouseUp}\r\n                        style={{ display: 'block', width: '100%', height: '100%', objectFit: 'contain' }}\r\n                      />\r\n                      <div\r\n                        ref={annotLayerRef}\r\n                        style={{ position: 'absolute', left: 0, top: 0, pointerEvents: 'none', width: '100%', height: '100%' }}\r\n                      >\r\n                        {renderAnomalyOverlays(imageLoaded)}\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <img src={maintenanceImageURL} alt=\"Thermal\" style={{ maxWidth: '100%', objectFit: 'contain' }} />\r\n                  )}\r\n                </div>\r\n                <div className=\"image-info\">\r\n                  <p><strong>Date & Time:</strong> {inspection.date || \"N/A\"}</p>\r\n                  <p><strong>Weather:</strong> {maintenanceWeather || \"N/A\"}</p>\r\n                  <p><strong>Uploader:</strong> {uploader}</p>\r\n                  <p><strong>Image Type:</strong> Maintenance</p>\r\n                </div>\r\n                {annotatedImage && (\r\n                  <div className=\"zoom-slider-container\">\r\n                    <label htmlFor=\"zoom-slider\">Zoom: {Math.round(zoomLevel * 100)}%</label>\r\n                    <input\r\n                      type=\"range\"\r\n                      id=\"zoom-slider\"\r\n                      min=\"1\"\r\n                      max=\"3\"\r\n                      step=\"0.1\"\r\n                      value={zoomLevel}\r\n                      onChange={e => setZoomLevel(parseFloat(e.target.value))}\r\n                    />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Annotated AI results & editable overlays */}\r\n        \r\n\r\n        {/* Analysis Log */}\r\n        {anomalies.length > 0 && (\r\n          <div className=\"modal-section\">\r\n            <h3>Analysis Log</h3>\r\n            <table className=\"log-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>#</th>\r\n                  <th>Source</th>\r\n                  <th>Severity</th>\r\n                  <th>Classification</th>\r\n                  <th>Details</th>\r\n                  <th>Comment</th>\r\n                  <th>User/Time</th>\r\n                  <th>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {visibleAnomalies.map((a, index) => (\r\n                  <tr key={a.id} className={a.id === hoveredAnomalyId ? 'log-row-highlight' : ''}>\r\n                    <td>{index + 1}</td>\r\n                    <td>{a.source === 'ai' ? 'AI' : 'Manual'}</td>\r\n                    <td>\r\n                      {a.source === 'ai' ? (\r\n                        <span className={`severity-badge ${a.severity?.toLowerCase()}`}>\r\n                          {a.severity || 'N/A'}\r\n                        </span>\r\n                      ) : (\r\n                        <select\r\n                          value={a.severity || ''}\r\n                          onChange={(e) => handleManualSeverityChange(a.id, e.target.value)}\r\n                          className=\"log-classification-select\"\r\n                        >\r\n                          <option value=\"\" disabled>Select...</option>\r\n                          {manualSeverityOptions.map(opt => <option key={opt} value={opt}>{opt}</option>)}\r\n                        </select>\r\n                      )}\r\n                    </td>\r\n                    <td>\r\n                      {a.source === 'ai' ? (\r\n                        <span>{a.classification || 'N/A'}</span>\r\n                      ) : (\r\n                        <select\r\n                          value={a.classification || ''}\r\n                          onChange={(e) => handleManualClassificationChange(a.id, e.target.value)}\r\n                          className=\"log-classification-select\"\r\n                        >\r\n                          <option value=\"\" disabled>Select...</option>\r\n                          {manualClassificationOptions.map(opt => <option key={opt} value={opt}>{opt}</option>)}\r\n                        </select>\r\n                      )}\r\n                    </td>\r\n                    <td>\r\n                      <div style={{ lineHeight: '1.4' }}>\r\n                        <div><strong>Pos:</strong> ({Math.round(a.x)}, {Math.round(a.y)})</div>\r\n                        <div><strong>Size:</strong> {Math.round(a.w)}x{Math.round(a.h)} px</div>\r\n                        {a.source === 'ai' && (\r\n                          <div>\r\n                            <strong>Conf:</strong> {a.confidence ? `${Math.round(a.confidence * 100)}%` : 'N/A'}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <textarea\r\n                        placeholder=\"Add comment...\"\r\n                        value={a.comment || ''}\r\n                        onChange={(e) => handleCommentChange(a.id, e.target.value)}\r\n                        className=\"log-comment-textarea\"\r\n                      />\r\n                    </td>\r\n                    <td>\r\n                      <div style={{ fontSize: '11px', lineHeight: '1.3' }}>\r\n                        {a.user_id && <div><strong>User:</strong> {a.user_id}</div>}\r\n                        {a.created_at && <div><strong>Created:</strong> {new Date(a.created_at).toLocaleString()}</div>}\r\n                        {a.updated_at && <div><strong>Updated:</strong> {new Date(a.updated_at).toLocaleString()}</div>}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <button className=\"danger-btn\" onClick={() => handleDeleteAnomaly(a.id)}>\r\n                        Delete\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n\r\n        {showBaselinePreview && baselineImageURL && (\r\n          <div className=\"modal-overlay\">\r\n            <div className=\"modal-card preview-card\">\r\n              <h3>Baseline Image Preview</h3>\r\n              <img src={baselineImageURL} alt=\"Baseline Preview\" className=\"preview-image\" />\r\n              <button onClick={() => setShowBaselinePreview(false)} className=\"inspection-cancel-btn\">Close</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"inspection-modal-buttons\" style={{ marginTop: 12 }}>\r\n          {progressStatus.aiAnalysis === \"Completed\" && (\r\n            <button className=\"inspection-complete-btn\" onClick={handleComplete}>Complete Reviewing</button>\r\n          )}\r\n          <button onClick={handleSave} className=\"inspection-save-btn\">Save</button>\r\n          <button onClick={onClose} className=\"inspection-cancel-btn\">Close</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}